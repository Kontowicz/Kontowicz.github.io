---
title: Username enumeration via response timing
published: true 
tags: portswigger authentication
---

## Lab description:
![Lab description](assets/username-enumeration-via-response-timing/lab_description.png)

## Solution:

Firstly download both candidate usernames and candidate passwords files. Then intercept login request in burp proxy:

![Burp proxy](assets/username-enumeration-via-response-timing/burp_proxy.png)

Send it to intruder, crear $, add $ to username and append many (something around 100-200 characters should be enough):

![Intruder](assets/username-enumeration-via-response-timing/intruder.png)

Also note that I add X-Forwarded-For header to bypass IP-based brute-force protection. 

As a first payload set load all numbers in range 0-254, list of those numbers can be generated by this command:

```
python3 -c "for i in range(0,255):print(i)" > num.list
```

Be aware of running this code because if a file named num.list exists in location where this code is executed it will be erased. Those code will create a file named num.list with all numbers from 0 up to 254. 

As a second payload set load candidate usernames file. Now start the attack. When it is done sort responses by response time (Columns->Response received). Username with the longest response time probably belongs to the real user. So now is the time to get a password. Like before prepare attack, you are on your own this time. After all you should get something like that:

![Result](assets/username-enumeration-via-response-timing/password.png)

Request with 302 status have the correct username and password.Â  
