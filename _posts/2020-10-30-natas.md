---
title: Wargames - Natas
published: false 
tags: game bandit
---

# ## [Level 0](https://overthewire.org/wargames/natas/natas0.html)

Username: natas0
Lab URL: http://natas0.natas.labs.overthewire.org/

![Message](assets/natas/0/message.png)

![Password](assets/natas/0/password.png)

password: gtVrDuiDfck831PqWsLEZy5gyDz1clto

# ## [Level 0 -> Level 1](https://overthewire.org/wargames/natas/natas1.html)

Username: natas1
Lab URL: http://natas1.natas.labs.overthewire.org

![Message](assets/natas/1/message.png)

So password is in comment tag on the page. So we need just to view pace soure code without right click. In firefox it can be done with following shortcut: [right ctrl] + u.

![Password](assets/natas/1/password.png)

password: ZluruAthQk7Q2MqmDeTiUij2ZvWy2mBi


# ## [Level 1 -> Level 2](https://overthewire.org/wargames/natas/natas2.html)

Username: natas2
Lab URL: http://natas2.natas.labs.overthewire.org

![Message](assets/natas/2/message.png)

Interesting part:

![File](assets/natas/2/interes.png)

So lets check it is possible to view content of files directory. It is possible and there are some files, pixel file we have alredy seen but what is in users.txt file.

![Password](assets/natas/2/password.png)

password: sJIJNW6ucpu6HPZ1ZAchaDtwd7oGrD14

# ## [Level 2 -> Level 3](https://overthewire.org/wargames/natas/natas3.html)

Username: natas3
Lab URL: http://natas3.natas.labs.overthewire.org/

Message:
![Message](assets/natas/3/message.png)

There is realy nothing!
![Page source code](assets/natas/3/source_code.png)

So I check robots.txt file, content:

![Robots](assets/natas/3/robots.png)

So s3cr3t/ is dissallowed to robots, it is interesting what is there:

![Direcotry content](assets/natas/3/direcotry_content.png)

And password is in users.txt.

password: Z9tkRkWmpt9Qr7XrR5jWRkgOU901swEZ

# ## [Level 3 -> Level 4](https://overthewire.org/wargames/natas/natas4.html)

Username: natas4
Lab URL: http://natas4.natas.labs.overthewire.org/

![Message](assets/natas/4/message.png)

So we must trick system we enter page from natas5. So let fire up burp. 

![Request headers](assets/natas/4/orginal_referer.png)

so we must change referef value to:

```
http://natas5.natas.labs.overthewire.org/
```

![Password](assets/natas/4/password.png)

password: iX6IOfmpN7AYOQGPwtn3fXpbaJVJcHfq 

# ## [Level 4 -> Level 5](https://overthewire.org/wargames/natas/natas5.html)

Username: natas5
Lab URL: http://natas5.natas.labs.overthewire.org/

![Message](assets/natas/5/message.png)

So we must be logged in. I check some pagese like login, sigin etc. And didn't find anything. I carefully check request, and find cookie loggedin:

![Request](assets/natas/5/request.png)

So change what will happen if we set 1 in loggedin cookie. Bingo! Password is found. 

![Password](assets/natas/5/password.png)

password: aGoY4q2Dc6MgDq4oL4YtoKtyAg9PeHa1

# ## [Level 5 -> Level 6](https://overthewire.org/wargames/natas/natas6.html)

Username: natas6
Lab URL: http://natas6.natas.labs.overthewire.org/

In initial page is these form:

![Message](assets/natas/6/message.png)

and nothing more, I checked source code as allways of course. So an interesing is button called "View sourcecode". Look what is there:

![Source code](assets/natas/6/code.png)

I copy only interesting part of code. So we need get to know value of "secret" variable. This variable is in inluded file "includes/secret.inc" so lets check this file, go to http://natas6.natas.labs.overthewire.org/includes/secret.inc this page look as a blank page, but like always check the source, and bingo! Secret value has been found!

![Secret](assets/natas/6/secret.png)

password: 7z3hEENjQtflzgnT29q7wAvMNfZdh0i9

# ## [Level 6 -> Level 7](https://overthewire.org/wargames/natas/natas7.html)

Username: natas7
Lab URL: http://natas7.natas.labs.overthewire.org/

In page source code is an hint:

![Page](assets/natas/7/page_interesing_part.png)

So we exacly know where passwords is located. We must onlny read this file. It can be done in this way:

```
http://natas7.natas.labs.overthewire.org/index.php?page=/etc/natas_webpass/natas8
```

More abut this bug you can read [here](https://wiki.owasp.org/index.php/Testing_for_Local_File_Inclusion)

![Password](assets/natas/7/password.png)

password: DBfUBfqQG69KvJvJ1iAbMoIpwSNQ9bWe


# ## [Level 7 -> Level 8](https://overthewire.org/wargames/natas/natas8.html)

Username: natas8
Lab URL: http://natas8.natas.labs.overthewire.org/

![Page](assets/natas/8/page.png)

As in level level 5 lets check "view sourcecode". 

![Source code](assets/natas/8/source_code.png)

So we have value of encoded secret, we only needd to get its orginal value. We need to first reverse hex2bin, then strrev and finally base64 encoding, it can be done by following code:

```
<?php
$encodedSecret = "3d3d516343746d4d6d6c315669563362";

function decodeSecret($secret) {
    return base64_decode(strrev(pack('H*', $secret)));
}

print(decodeSecret($encodedSecret));
?php>
# Print: oubWYf2kBq
```

After submiting decoded value I get password to the next level.

![Password](assets/natas/8/password.png)

password: W0mMhUcRRnG8dcghE4qvk3JA9lGt8nDl

# ## [Level 8 -> Level 9](https://overthewire.org/wargames/natas/natas9.html)

Username: natas9
Lab URL: http://natas9.natas.labs.overthewire.org/

![Page](assets/natas/9/page.png)

As in previwious level: 

![Code](assets/natas/9/code.png)

So if "needle" exist in request then value from request is assigned to valiable, if this value is not epty string execute following code: 

```
passthru("grep -i $key dictionary.txt");
```

In this case crucial thing is good understanding of [passthru function](https://www.php.net/manual/en/function.passthru.php). More abut this type of bug you can read [here](https://owasp.org/www-community/attacks/Command_Injection).

You can get password by submiting following query: 

```
testtttt; cat /etc/natas_webpass/natas10
```

Why it works you must understand on your own.

password: nOpp1igQAkUzaI1GUUjzn1bFVj7xCNzu

# ## [Level 9 -> Level 10](https://overthewire.org/wargames/natas/natas10.html)

Username: natas10
Lab URL: http://natas10.natas.labs.overthewire.org/

This level is very simillar to previwous, but now not all characters are allowed:

![Code](assets/natas/10/code.png)

Illegal are following characters: 

```
&
|
;
```

In that case we can't use previwous payload because it wouldn't work. Value to server is passed via url - needle param. So it will by my entry point. We can use new line character '\n' didn't work, I test few encoding of this character and this works:

```
http://natas10.natas.labs.overthewire.org/?needle=%0Acat%20/etc/natas_webpass/natas11
```

![Password](assets/natas/10/password.png)

password: U82q5TCMMQ9xuFoI3dYX61s7OZD9JKoK

# ## [Level 10 -> Level 11](https://overthewire.org/wargames/natas/natas11.html)

Username: natas11
Lab URL: http://natas11.natas.labs.overthewire.org/

Get key:

```
function xor_encrypt($in) {  
    $key = json_encode(array( "showpassword"=>"no", "bgcolor"=>"#ffffff"));  
    $text = $in;  
    $outText = '';  
  
    // Iterate through each character  
    for($i=0;$i<strlen($text);$i++) {  
    $outText .= $text[$i] ^ $key[$i % strlen($key)];  
    }  
  
    return $outText;  
}  
  
echo xor_encrypt(base64_decode($cookie));  
```

Encode new cookie:
```
function xor_encrypt($in) {
    $key = 'qw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jq';
    $text = $in;
    $outText = '';

    // Iterate through each character
    for($i=0;$i<strlen($text);$i++) {
    $outText .= $text[$i] ^ $key[$i % strlen($key)];
    }

    return $outText;
}
$data = array( "showpassword"=>"yes", "bgcolor"=>"#ffffff");  
echo base64_encode(xor_encrypt(json_encode($data)));  
```

password: 